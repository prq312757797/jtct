
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>web打印POS小票机代码</title>
</head>
<body>
<script src="LodopFuncs.js"></script> 
<script src="__ROOT__/Public/Lodop/aa.js"></script> 
<object id="LODOP_OB" classid="clsid:2105C259-1E0C-4534-8141-A753534CB4CA" width=0 height=0> 
<embed id="LODOP_EM" type="application/x-print-lodop" width=0 height=0 pluginspage="install_lodop32.exe"></embed>
</object> 
        <input id="Btn_dy" type="button" value="打印预览再点打印" onclick="prn_Preview()" />
         <input id="Btn_dy2" type="button" value="直接打印的话，POS机停不下来" onclick="prn_PRINT()" />
<br/>POS机设置为默认打印机即可，就是直接打印会停不下来，有解决方案请留言。


       
 
        <script type="text/javascript" language="javascript">
            var LODOP; //声明为全局变量  
            function prn_Preview() {
                CreatePrintPage();
                LODOP.PREVIEW();
            };
            function prn_PRINT() {
                CreatePrintPage();
                LODOP.PRINT();
            };
            function CreatePrintPage() {
                var date = new Date();
                var year = date.getFullYear();
                var month = date.getMonth() + 1;
                var day = date.getDate();
                var hour = date.getHours();
                var minute = date.getMinutes();
                var second = date.getSeconds();
                LODOP = getLodop(document.getElementById('LODOP1'), document.getElementById('LODOP_EM1'));
                //LODOP.SET_PRINT_PAGESIZE(1, 230, 230, "strPageName");
                LODOP.PRINT_INITA(0, 0, 230, 230, "打印条码"); 
                LODOP.ADD_PRINT_BARCODE(0, 40, 120, 120, "QRCode", "21H74P7MILE3AGQK");
                LODOP.ADD_PRINT_TEXT(110, 10, 230, 20, "编号：21H74P7MILE3AGQK");
                LODOP.ADD_PRINT_TEXT(130, 10, 230, 20, "分类：金刚菩提 - 大金刚");
                LODOP.ADD_PRINT_TEXT(150, 10, 230, 20, "尺寸：15.00 mm - 15.00 mm");
                LODOP.ADD_PRINT_TEXT(170, 10, 230, 20, "售价：320.00 元");
                LODOP.ADD_PRINT_TEXT(190, 10, 230, 20, "打印时间：" + year + "/" + month + "/"+ day + " " + hour + ":"+ minute + ":" + second);
                //LODOP.SET_PRINT_STYLEA(0, "GroundColor", "#0080FF");
            };	 

</script>
</body>
</html>